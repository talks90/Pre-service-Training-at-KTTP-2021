
# 速記
# ccna2 4.2
- 每次傳輸封包的大小取決於傳輸層的媒體
- 如乙太網路為 1500 byte，扣除標頭約 30 byte，封包大小約 1470 byte
- 防火牆是第 4 層設備，它會把封包解封裝到第 4 層，分析它的 port number，決定封包可不可以通過
- 而所謂的第 7 層防火牆，就是會把封包解封到第 7 層分析資料內容，所以可以做到區分軟體決定是否封鎖
- multi-cast ，多點傳送，又稱群播，在現在的應用非常廣泛；直播，蔡阿嘉年收入約 2 千萬
- 台灣三大網路：政府網路 GSN（委由中華電信維護）、學術網路 TA-NET（預設路由 last rouser 指向美國  UU-NET，預設路由要付費；教育部每年要付UU-NET ○億）、中華電信 HI-NET（它沒有預設路由）
- 無法決定路由 - 封包丟棄，並回覆一筆 ICMP
- T1 傳輸速度 1544k
- 路由資訊協定 RIP 只看跳數，不看頻寬；最多 15 跳
- OSPF 開放最短路徑優先，依頻寬計算出傳輸成本
- CISCO 專用 EIGRP，除了看頻寬之外，還看延遲、負載、可靠性；總共 5 個值
- 如果條件都一樣時，可以支援負載平衡（等價負載平衡）
- EIGRP 支援非等價負載平衡
- AD 管理距離，值越小越優先（以下項目 CCNA 必考）
	
路由來源 | AD 管理距離
:---: | :---:
直連 | 0
靜態 | 1
內部 EIGRP | 90
OSPF | 110
RIP | 120
外部 EIGRP | 170 (CCNA 不考)

# 路由表
- 路由表來源
	- 直連路由
	- 遠端路由
		- 靜態設定
		- 動態取得
	- 儲存在 RAM，cisco 設定可儲存 167678 筆
	- enable 模式，下 `show ip route`
	- C, L 為一組
	- via 下一跳 IP
	- via null0 把封包丟掉的意思
- serial 一般是透過數據機，所以要設定 clock rate
- 未來從事網管工作，註解的工作很重要，不要相信自己的記憶；但是要維持自己的不可取代性

# 靜態路由
有 2 種
- 指向特定網路的靜態路由
- 預設靜態路由

解釋
- next-hop-ip 下一跳，顯示路由表時，會有 AD 值，要找 2 次
- exit-intf 出去的介面，如果介面不是一對一連接，其他不該收的也會收到
- next-hop-ip, exit-intf 2 個都設，叫完全指定的靜態路由
- 0.0.0.0 全部都可以符合
- 缺點 - 有變動時，有幾顆路由器就要改幾個

# 動態路由
- 路由器之間用相同的路由資訊協定，讓路由器自己取得
- router ? 可以查路由器支援什麼協定
	- eigrp - 新版英文教材不教，但 ccna 考
	- IS-IS - ccnp 的範圍
- NG - next generation 次世代

# ccna 2 ch7
- 7.1.1.1 的表要記

\ | 內部閘道協定 | | | 外部閘道協定
--- | --- | --- | --- | --- |
\ | 距離向量 | | 鏈路狀態 | | 路徑向量
IPv4 | RIPv2 | EIGRP | 
IPv6

# 動態路由協定的用途
- 發現遠端網路
- 維護最新路由資訊
- 選擇最佳路徑

# 協定的主要元件
- 資料結構
- 路由協定訊息
- 演算法

EIGRP 用 D... 演算法

多久更新、更新哪些資料

# 靜態路由何時用
- 小型網路
- 末稍網路
- 存取單一靜態路由

## 優勢
- 小型網路容易做
- 安全
- 不需要 CPU 用演算法解算

# 動態路由何時用
- 2 個路由器以上就適合

## 優點
- 不受網路規模限制

# 冷啟動
- 電腦、資訊設備都一樣，有分冷啟動和熱啟動
	- 冷啟動是一直到斷電，完全關機再重新啟動
	- 熱啟動是把設定、記憶體…等做清除的動作；但有時因為程式設計不良，在程式結束後沒有釋放記憶體，導致最後記憶體不足，所以定期要重新開機

- RIP - 定時更新，收斂慢
- EIGRP - 觸發更新，收斂快

- 有級別 RIPv1, IGRP 目前已經不用
- 現在是無級別 RIPv2, EIGRP ，一定要有子網路遮罩

- 不同網路之間，都走 BGP 路由協定
- 需要多重連結（連接多個 ISP）時，需要申請 AS number，以及屬於自己的 IP，避免其中一個 ISP 斷線時，只有專屬於該 ISP 的 IP；目前只申請得到 IPv6 的 IP 了

# 比較路由協定
- 7.1.4.7, CCNA 會考
- VLSM 可以混用不同長度的子網路
- EIGRP 是特殊的存在，雖然歸類在距離向量，但功能是偏鏈路狀態

- RIP 用 貝爾曼 - 福特 (Bellman Ford) 演算法
- IGRP, EIGRP 用 DUAL 擴散更新演算法

- cisco 的指令都是小寫，所以自定義的名稱建議用大寫區分

- SPF 演算法 - 最短路徑優先，又稱 Dijakstra 演算法，用來計算每段路徑的成本值

# 鏈路狀態路由程序
- 路由器負責自己的直通網路
- 怎麼認識鄰居？透過 hello
- 泛洪，不是只有給鄰居，鄰居還會轉送給鄰居

# 鏈路狀態動態路由
- 有拓樸圖
- 快速收斂
- 事件驅動更新 - 泛洪
- 階層式設計 - 分層之後，可以用區塊來做更新

## 缺點
- RAM
- CPU
- 頻寬

## 協定
- OSIF
- IF-IF

# 動態獲取的 IPv4 路由
- 不整理會像北京 router 一樣，16 萬筆紀錄直接塞爆
- 1 級路由，跟等級一樣，且可以出去的
- 1 級父路由 + 2 級子路由
	- 1級父路由：匯整子路由用
	- 2 級子路由決定由哪個介面出去

# IPv4 路由怎麼找
1. 1 級路由
2. 2 級路由
3. 超網
4. 預設

- 遮罩找最長匹配

# 單區域 OSPF
## 開放最短路徑優先 OSPF
- VLSM
- CIDR 無級別網際網路的路由
- SPF 演算法 (Dijksta 演算法)
- 支援 MD5
- AD 110
- LSA
- LSDB 拓樸表
- 單區域統一用區域 0


# OSPF
## 多區協定
- 比較特別的是會包路由器 ID 及區域 ID

## 訊息
- 路由器會定期發 hello
- LSA 有很多類型，CCNA 不考，CCNP 必考

## OSFP 狀態
- 開始 DOWN
- 啟動 FULL

### 選 DR, BDR
- 太多鄰居會造成鄰居表很大
- 一旦停電，大家一起泛洪，會造成網路塞車
- 通知送給 DR, BDR （班長、副班長）
- DR 在由 DR 通知，DR 不在由 BDR 通知

下次從 8.2 開始