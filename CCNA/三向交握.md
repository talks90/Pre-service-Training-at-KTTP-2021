#CCNA 

# 三向交握的流程

- 當兩台主機採用 TCP 協定進行通訊時，在交換資料之前將建立連線。通訊完成後，要關閉會談並終止連線；連線和會談機制保障了 TCP 的可靠性功能
- 在 TCP 連線的程序分為三個步驟：
	1. 來源端 A 請求與伺服器 B 進行 A-B 會談
	2. 伺服器確認進行 A-B 會談，同時也請求用戶端進行 B-A 會談
	3. 來源用戶端確認 B-A 會談
![](../img/Pasted%20image%2020201029223712.png)
> 注意來源連接埠和目的連接埠的變化

 - TCP 資料段標頭中，有 6 個包含控制資訊的 1 位元欄位用於管理 TCP 程序

代號 | 用途 | 備考
--- | --- | ---
URG | 緊急指標欄位（重要）|
ACK | 確認欄位（重要）| 跟三向交握分析有關
PSH | 推送功能 |
RST | 重置連線 |
SYN | 同步序號 | 跟三向交握分析有關
FIN | 發送者已傳輸完所有資料 |

# 終止連線

- 要關閉連線時，資料段標頭要設成完成 (FIN) 控制旗標
- 每個單向 TCP 會談都要終止，每個單向都要做 FIN和 ACK 的二次交握；也就是說，要終止整個 TCP 會談，需要實作四次交換
	1. 任一端 (這裡以 A 為例) 已經沒有其他資料要傳了，它就發送一個帶 FIN 旗標設定的資料段給 B
	2. B 發送 ACK 資訊，確認 A 的 FIN 資訊
	3. B 向 A 發送 FIN 資訊，終止雙方的會談
	4. A 發送 ACK 資訊，確認收到 B 發出的 FIN 資訊

![](../img/Pasted%20image%2020201029230713.png)

# 流量控制

![](../img/Pasted%20image%2020201029231755.png)![](../img/Pasted%20image%2020201029231904.png)