#CCNA 

- 資料在網路上傳遞的時候，資料都是用二進制形式在傳遞
- 制訂出美國標準資訊交換碼 (ASCII) ，讓我們可以把平常在看的字母可以對照成二進制的形式

# 各進制轉換練習
- 十進制轉二進制 CCNA1 - 8.1.1.7
- 二進制遊戲 CCNA1 -  8.1.1.8

# 子網路遮罩 - 很重要，一定要懂！！！
- 子網路遮罩用來標識兩部電腦是否在同一個網段內
![](../img/Pasted%20image%2020201101224427.png)
- 我們有時會看到像 192.168.0.1/24 這樣的表示式
- /24 表示轉成二進制後，由左至右連續1的數量
- 將 IP 及 遮罩的二進位值，做 AND 運算

## 例題
### 192.168.36.131/24 的網段為何？
```
   11000000. 10101000. 00100100. 10000011
   11111111. 11111111. 11111111. 00000000
AND--------------------------------------
   11000000. 10101000. 00100100. 00000000
```
- 主機位址： 192.168.36.0 - 192.168.36.255
- 網路位址：192.168.36.0
> 主機部分的值全是 0（第 1 個 IP）
- 廣播位址：192.168.36.0
> 主機部分的值全是 1（最後 1 個 IP）
- 可用的 IP：192.168.36.1 - 192.168.36.254

### 192.168.36.131/25 的網段為何？
```
   11000000. 10101000. 00100100. 10000011
   11111111. 11111111. 11111111. 10000000
AND--------------------------------------
   11000000. 10101000. 00100100. 10000000
```
網路位址：192.168.36.128
廣播位址：192.168.36.255
可用的 IP：192.168.36.129 - 192.168.36.254

# 子網路切割
- 切割的主要目的就是把廣播領域縮小，減少傳輸成本
> 網路部分往左 supernet 超網路合併
> 網路部分往右 subnet 子網路切割

## 例題
- 192.168.36.131/25 要再切分為 4 個部門怎麼切？ 
```
表示網路部分要再往右移 2 字元 (2^2=4)
```
網段 | 二進位表示（末 8 碼） | 網路位址 | 廣播位址
:---: | :---: | --- | ---
1 | 1000 0000 | 128/27 | 159/27
2 | 1010 0000 | 160/27 | 191/27
3 | 1100 0000 | 192/27 | 123/27
4 | 1100 0000 | 124/27 | 255/27

# IPv4 位址的類型
## public 公有位址
## private 私有位址
- 私有位址不能連上 Internet 路由
- 依據 - RFC 1918
- 區塊
	- 10.0.0.0 到 10.255.255.255 (10.0.0.0/8)
	- 172.16.0.0 到 172.31.255.255 (172.16.0.0/12)
	- 192.168.0.0 到 192.168.255.255 (192.168.0.0/16)

## 專用位址
### 迴路
- 主機用於向自身發送通訊的一個特殊位址；可以測試本地主機上的 TCP/IP 設定
- 範圍 - 127.0.0.0 到 127.255.255.255

### 鏈路本地位址
- 範圍 - 169.254.0.0 到 169.254.255.255 (169.254.0.0/16)
- 在沒有 DHCP 的網段設定動態取得 IP 或 DHCP 的 IP 都已經派發完時，本機透過 **APIPA** (Automatic Private IP Addressing) 機制，自行宣告的 IP
- 取得 IP 後會先廣播，看看本地網段內是否有和其他電腦衝突
- 只有本地網段可以通

### TEST-NET 位址 - 教學使用
- 範圍 - 192.0.2.0 到 192.0.2.255 (192.0.2.0/24) 

### 實驗位址
- 範圍 - 240.0.0.0 到 255.255.255.254
- 依據 - RFC 3330

## 傳統有級別定址 classful
- 注意，沒有標示遮罩就表示預設遮罩是 Class 級別

級別 |  二進位表示 |IP 位址
--- | --- | ---
Class A | 0xxxxxxx.xxxxxxxx.xxxxxxxx.xxxxxxxx | 0.xx.xx.xx - 127.xx.xx.xx
Class B | 10xxxxxx.xxxxxxxx.xxxxxxxx.xxxxxxxx | 128.xx.xx.xx - 191.xx.xx.xx
Class C | 110xxxxx.xxxxxxxx.xxxxxxxx.xxxxxxxx | 192.xx.xx.xx - 223.xx.xx.xx
Class D | 1110xxxx.xxxxxxxx.xxxxxxxx.xxxxxxxx | 224.xx.xx.xx - 239.xx.xx.xx
Class E | 1111xxxx.xxxxxxxx.xxxxxxxx.xxxxxxxx | 240.xx.xx.xx - 

# IPv6 位址
- IPv6 可用的位址數量是 IPv4 的 2^96 倍，所以通通都是 public ip，沒有 private ip 這回事

## IPv4 走向 IPv6 的因應方式有 3 種
 要轉換不是一天可以完成滴~在這個過渡期間，我們採用下列以下 3 種方式來因應
 ### 雙重堆疊
 - 這種方式允許 IPv4 和 IPv6 在同一網路中共存，也就是設備上同時執行 IPv4 和 IPv6 通訊協定；2 個一起來，成本當然也就比較高囉~

### 隧道
- 傳輸兩端可以支援 IPv6，但網路本身不支援；那就把 IPv6 當做資料，包到 IPv4 的封包裡
 
### 轉換
- 透過**網路位址轉換 64 (NAT64)** 把 IPv6 跟 IPv4 的封包互相做轉換

## IPv6 位址表示方法
![](../img/Pasted%20image%2020201103153229.png)
- IPv6 位址的長度為 128 位元；有 8 個區塊，每個區塊有 4 個 16 進制數 = 16 個 2 進制數
- IPv6 用位址/前置碼長度，來表示位址
- 在 /64 全球單點傳送位址中，前 4 個區塊是位址的網路部分，其中第 4 個區塊表示子網 ID，剩下的 4 個區塊是介面 ID

### 32 個字元會不會太長了？！壓縮一下吧！
1. 標準格式
> 2001:0DB8:0000:1111:0000:0000:0000:0200
2. 省略前導 0 - 每個區塊單獨看，把前導的 0 省略；如果全為 0 ，最少要留 1 個 0
> 2001:DB8:0:1111:0:0:0:200
3. 省略全 0 資料段 - 1 個以上連續由 0 組成的區塊可以用雙冒號 (::) 取代；但每個位址中只能用一次，否則會無法標示唯一的位址
> 遇到前後有一樣數量的區塊，則擇一省略
> 2001:DB8:0:1111::200  

## IPv6 位址的類型有 3 種
### 單點傳送
- 位址設在可支援 IPv6 的裝置介面上；位址被設過後，其他人就不能再重複設定了
- 來源 IPv6 位址一定是單點傳送位址

### 多點傳送
- 多點傳送位址用來把單個 IPv6 封包發送到多個目的地
- 雖然 IPv6 沒有廣播位址，但是多點傳送位址的本質就跟廣播的效果相同

### 任播
-  IPv6 任播位址是可分配到多個裝置的 IPv6 單點傳送位址
-  發送至任播位址的封包會路由到最近的擁有該位址的裝置

## IPv6 單點傳送位址有 6 種
![](../img/Pasted%20image%2020201103140953.png)
### 全域單點傳送
- IPv6 全域單點傳送位址具有全域唯一性和 IPv6 Internet 可路由性
- 注意 - 位址 2001:0DB8::/32 已經留作文件目的，包括範例用途
- 當使用 SLAAC 時，裝置從 ICMPv6 RA 接收前置碼，並將其與介面 ID 結合，組成全域單點傳送位址

- 全域單點傳送位址包括 3 個部分![](../img/Pasted%20image%2020201103151927.png)
	- 全域路由前置碼
	> 全域路由前置碼為供應商（如 ISP）分配給客戶或站點的位址的前置碼或網路部分。目前，RIR 分配 /48 全域路由前置碼給客戶。這包括從公司企業網路到單個家庭網路中的每個站點。對於多數客戶來說，該位址綽綽有餘
	- 子網 ID
	> 組織使用子網 ID 確定其站點的子網
	- 介面 ID
	> IPv6 的介面 ID 相當於 IPv4 位址的主機部分。使用術語「介面 ID」是因為單個主機可能有多個介面，而每個介面又有一個或多個 IPv6 位址

![](../img/Pasted%20image%2020201103152709.png)
- 鏈路本地前置碼的開頭是 FE80::/10。裝置通常使用 FE80::/64 作為前置碼/前置碼長度後接介面 ID，組成鏈路本地位址
- 注意 - 與 IPv4 不同，在 IPv6 中，全 0 和全 1 主機位址可以分配給裝置。全 1 位址可以使用是因為 IPv6 中不使用廣播位址。全 0 位址也可使用，但它留作子網路由器任播位址，應僅分配給路由器

### 鏈路本地
![](../img/Pasted%20image%2020201103151016.png)
- 範圍 - FE80::/10；/10 表示前 10 位元是 1111 1110 10xx xxxx
- 第一個十六位元組的範圍是 1111 1110 10 00 0000 (FE80) 到 1111 1110 10 11 1111 (FEBF)
- 用來跟與同一鏈路裡的其他裝置通
- 在 IPv6 中，鏈路是指一個子網；鏈路本地位址僅限於單個鏈路
- 它們的唯一性僅在該鏈路上得到保證，因為它們在該鏈路之外不具有可路由性；換句話說，路由器不會轉送具有鏈路本地來源位址或目的位址的封包
- 不同於 IPv4 鏈路本地位址，IPv6 的鏈路本地位址對網路的各個方面均具有重要意義；對 IPv6 而言，全域單點傳送位址不是必要的，但每個支援 IPv6 的網路介面均一定要有鏈路本地位址
- 如果沒有幫介面設鏈路本地位址，裝置會在不與 DHCP 伺服器通訊的情況下自動新增自己的位址；支援 IPv6 的主機會新增 IPv6 鏈路本地位址，即使沒有為該裝置分配 IPv6 全域單點傳送位址。這允許支援 IPv6 的裝置與同一子網中的其他支援 IPv6 的裝置通訊。這包括與預設閘道（路由器）通訊
- IPv6 路由協定也使用 IPv6 鏈路本地位址交換訊息和作為 IPv6 路由表中的下一跳位址

### 迴路
- 迴路位址除最後一位元外全為 0，也就是 ::1/128 或 ::1
- 迴路位址不能設給實體介面。與 IPv4 迴路位址類似
- 用來發封包給自己，測試本機的 TCP/IP 設定

### 未指定位址
- 未指定位址是全 0 位址，也就是 ::/128 或 ::
- 不能設給介面，只能拿來當 IPv6 封包的來源位址
- 在裝置尚無永久 IPv6 位址時或封包的來源位址與目的位址不相關時，未指定位址當作來源位址

### 唯一本地
- 範圍 -  FC00::/7 到 FDFF::/7
- 跟 IPv4 的 RFC 1918 有點像，但其實也很不一樣
- 唯一本地位址在一個站點內或有限站點數之間當作本地位址。這些位址在全域 IPv6 中不具有可路由性

### 嵌入的 IPv4
- 用來幫助從 IPv4 向 IPv6 轉移

## IPv6 全域單點傳送位址的取得方式
### 無狀態位址自動設定 (SLAAC)
- 可以發出**路由器請求 (RS) **向[IPv6 路由器](CCNA/%E8%B7%AF%E7%94%B1%E5%99%A8.md#IPv6%20%E8%B7%AF%E7%94%B1%E5%99%A8)索取前置碼、前置碼長度和預設閘道位址資訊；IPv6 路由器收到 RS 訊息後，會立即發出路由器通告回應
- 可以根據本地[IPv6 路由器](CCNA/%E8%B7%AF%E7%94%B1%E5%99%A8.md#IPv6%20%E8%B7%AF%E7%94%B1%E5%99%A8)的定期（預設 200秒一次）** ICMPv6 路由器通告 (RA) **訊息獲取必要資訊
- [IPv6 路由器](CCNA/%E8%B7%AF%E7%94%B1%E5%99%A8.md#IPv6%20%E8%B7%AF%E7%94%B1%E5%99%A8)會用鏈路本地位址作為來源 IPv6 位址來發送 ICMPv6 RA 訊息；使用 SLAAC 的裝置使用路由器的鏈路本地位址作為其預設閘道位址

### [DHCPv6](CCNA/DHCP.md#DHCPv6)
![](../img/Pasted%20image%2020201104004528.png)
- 裝置可以從 DHCPv6 伺服器接收全部或部分 IPv6 位址資訊；這取決於 ICMPv6 RA 訊息中指定的是選項 2（SLAAC 和 DHCPv6）還是選項 3（僅限 DHCPv6）
- 此外，主機 OS 也有可能會選擇忽視路由器 RA 訊息中的任何內容，而是選擇直接從 DHCPv6 伺服器中獲取 IPv6 位址和其他訊息
- 在網路中部署 IPv6 裝置前，最好先驗證主機是否觀察路由器的 ICMPv6 RA 訊息中的選項
- 裝置可動態獲取 IPv6 全域單點傳送位址，也可在同一介面上設定多個靜態 IPv6 位址。IPv6 允許在同一介面上設定屬於同一 IPv6 網路的多個 IPv6 位址
- 裝置還可以設定多個預設閘道 IPv6 位址。有關如何決定選用何種來源 IPv6 位址或使用何種預設閘道位址的更多資訊，請參閱 RFC 6724，“IPv6 預設位址選擇”

#### 介面 ID
- 如果用戶端不使用 RA 訊息中的資訊，而僅依賴 DHCPv6，則 DHCPv6 伺服器會提供整個 IPv6 全域單點傳送位址，包括前置碼和介面 ID
- 但是，如果使用選項 1（僅限 SLAAC）或選項 2（SLAAC 和 DHCPv6），則用戶端不會從該程序中獲取位址的實際介面 ID 部分；用戶端裝置必須確定其自身的 64 位元介面 ID，可以使用 [[CCNA/EUI-64 程序]]，也可以隨機產生一個 64 位元編號

#### 隨機產生的介面 ID
- 根據作業系統，裝置可以使用隨機產生的介面 ID，而不使用 MAC 位址和 EUI-64 程序。
	- 從 Windows Vista 開始，Windows 使用隨機產生的介面 ID
	- Windows XP 和之前的 Windows 作業系統均使用 EUI-64
- 確認是否使用 EUI-64 新增位址的簡單方法是查看介面 ID 中間的 FFFE![](../img/Pasted%20image%2020201104005823.png)
- 介面 ID 新增後（無論是使用 EUI-64 程序還是透過隨機產生），它都可以結合 IPv6 前置碼來新增全域單點傳送位址或鏈路本地位址
